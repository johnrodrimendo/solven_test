<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="templates/mainTemplate">
<head>

    <title>Reset Password</title>

    <!--Jquery Validation-->
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/jquery-validation/dist/jquery.validate.min.js'}"></script>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/jquery-validation/dist/additional-methods.min.js'}"></script>

    <script th:inline="javascript">
        /*<![CDATA[*/
        $(document).on('ready', function () {
            var jsBranding = [[${@brandingService.getExtranetBrandingAsJson(#httpServletRequest)}]];
            customStyleTemplateCssClass(jsBranding);

            function customStyleTemplateCssClass(data){
                if(data == null) return;
                var style = document.createElement('style');
                style.type = 'text/css';
                style.innerHTML = ``;
                //login
                if(data.faviconUrl){
                    $('head').append('<link href="'+data.faviconUrl+'" rel="icon"/>');
                }
                if(data.loginLogoImg) style.innerHTML += `.login-page {background: ${data.loginLogoImg} !important} \n`;
                if(data.loginBackground) style.innerHTML += `#generateButton {background-color: ${data.loginBackground} !important } \n`;
                if(data.loginButtonBackgroundColor) style.innerHTML += `#generateButton {background-color: ${data.loginButtonBackgroundColor} !important } \n`;
                if(data.loginButtonTextColor) style.innerHTML += `#generateButton {color: ${data.loginButtonTextColor} !important }\n`;
                if(data.loginButtonTextColor) style.innerHTML += `#generateButton {color: ${data.loginButtonTextColor} !important }\n`;
                if(data.loginInputBackgroundColor) style.innerHTML += `.input-landing {background-color: ${data.loginInputBackgroundColor} !important }\n`;
                if(data.loginInputTextColor) style.innerHTML += `.input-landing {color: ${data.loginInputTextColor} !important }\n`;
                if(data.headerBackgroundColor) style.innerHTML += `.page-header.navbar, .page-header.navbar .top-menu .navbar-nav > li.dropdown-dark .dropdown-menu {background: ${data.headerBackgroundColor} !important;} \n`;
                if(data.headerTextColor) style.innerHTML += `.page-header.navbar .top-menu .navbar-nav > li.dropdown-language > .dropdown-toggle > .langname, .page-header.navbar .top-menu .navbar-nav > li.dropdown-user > .dropdown-toggle > .username, .page-header.navbar .top-menu .navbar-nav > li.dropdown-user > .dropdown-toggle > i, #countdown {color: ${data.headerTextColor} !important;} \n`;
                if(data.loginLogoImg){
                    style.innerHTML += `i.icon:nth-child(1), i.icon:nth-child(2){display : none !important;}; \n`;
                    $('.custom-logo-img').show();
                    $('.custom-logo-img').attr("src",data.loginLogoImg);
                }
                document.getElementsByTagName('head')[0].appendChild(style);
            }
        });


        /*]]>*/
    </script>
    
    <script th:inline="javascript">
        /*<![CDATA[*/

        system.unloadAlert = false;

        $(document).on('ready', function () {
            $('#generateButton').click(function (evt) {
                evt.preventDefault();
                $(this).loading('', 2);
                defaultAjax({
                    url: /*[[@{/extranetEntityReset}]]*/null,
                    type: 'POST',
                    data: {
                        token : /*[[${token}]]*/null,
                        password : $('#password').val(),
                        repassword : $('#repassword').val()
                    },
                    success: function (data) {
                        $('#generateButton').unloading();
                        swal({
                            title: "",
                            text: "Tu contraseña ha sido guardada exitosamente.",
                            type: "success"
                        },function() {
                            window.location.replace(window.location.origin + '/funcionarios');
                        });
                    },
                    error: function() {
                        $('#generateButton').unloading();
                        swal("Hubo un error int&eacute;ntalo nuevamente.");
                    }
                });
            });
        });
        /*]]>*/
    </script>

</head>
<body>

<th:block layout:fragment="content">
    <section class="login-page">
        <div class="hero-content">
            <h1>


                <th:block th:switch="${@brandingService.isBranded(#httpServletRequest) and @brandingService.getEntityBranding(#httpServletRequest).entity.id == T(com.affirm.common.model.catalog.Entity).BANCO_DEL_SOL}">
                    <a th:href="@{/}" th:case="true">
                        <img src="https://solven-public.s3.amazonaws.com/img/bancodelsol/bancodelsol_logo-white.png" atl="Banco de Sol" title="Banco de Sol" height="50"/>
                        <span class="hidden">Banco del Sol</span>
                    </a>
                    <a th:href="@{/}" th:case="false">
                        <i class="icon icon-solven"></i>
                        <i class="icon icon-solven-iso"></i>
                        <img class="custom-logo-img" src="" alt="" style="display: none"/>
                        <span class="hidden">Solven</span>
                    </a>
                </th:block>
            </h1>
            <div class="form-wrap">
                <div class="login-username">
                    <form action="#" id="loginForm" autocomplete="off">
                        <div class="field" style="color: white">
                            <label>Escriba una contraseña para su cuenta.</label>
                            <div style="text-align:left !important;font-size: small;margin-bottom: 10px;">
                                <li>Debe contener por lo menos
                                    <span th:text="${T(com.affirm.system.configuration.Configuration).MIN_PASSWORD}"></span> caracteres.</li>
                                <li>Debe contener por lo menos un número, una letra y/o un caracter especial [ !@#$%^&amp;*_ ].</li>
                                <li>No puede ser igual al usuario.</li>
                            </div>
                        </div>
                        <div class="field">
                            <input autocorrect="off" autocapitalize="none" type="password" id="password" name="password"
                                   class="input-landing" placeholder="Contrase&ntilde;a" autocomplete="off"/>
                        </div>
                        <div class="field">
                            <input autocorrect="off" autocapitalize="none" type="password" id="repassword" name="repassword"
                                   class="input-landing" placeholder="Repetir Contrase&ntilde;a" autocomplete="off"/>
                        </div>
                        <div class="actions">
                            <button id="generateButton" class="button bg-red">Regenerar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
</th:block>


<th:block layout:fragment="footer">
    <th:block th:replace="fragments/footers :: footerDefault"></th:block>
</th:block>

</body>
</html>