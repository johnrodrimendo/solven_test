<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<th:block th:fragment="question">
    <th:block th:replace="loanApplication/formQuestions/questionConfig :: config"></th:block>

    <div class="questions-section fadeInRight">
        <div class="circle-progress-bg"></div>
        <div class="wrap-note">
            <!--<figure>
                <img src="/img/icons/ofertas.jpg" alt=""
                     th:if="${@countryContextService.isCountryContextInArgentina(#httpServletRequest)}"/>
                <img src="/img/icons/ofertas-peru.jpg" alt=""
                     th:if="${@countryContextService.isCountryContextInPeru(#httpServletRequest)}"/>
            </figure>-->
            <p th:if="${showMessageOffer}" th:utext="#{questions.block.lookingYourOffer}"></p>
            <div class="process-loading-container circle-progress-question">
                <div class="loading-content">
                    <div class="sk-circle">
                        <div class="sk-circle1 sk-child"></div>
                        <div class="sk-circle2 sk-child"></div>
                        <div class="sk-circle3 sk-child"></div>
                        <div class="sk-circle4 sk-child"></div>
                        <div class="sk-circle5 sk-child"></div>
                        <div class="sk-circle6 sk-child"></div>
                        <div class="sk-circle7 sk-child"></div>
                        <div class="sk-circle8 sk-child"></div>
                    </div>
                    <span class="loading-text">Cargando<span>.</span><span>.</span><span>.</span></span>
                </div>
            </div>
        </div>
    </div>

    <script th:inline="javascript">
        /*<![CDATA[*/
        console.log('INIT i');
        window.io_global_object_name = "IGLOO"
        window.IGLOO = window.IGLOO || {
            "install_flash": false,
            "bb_callback": function (bb, complete) {
                if (complete) {
                    sendBB(bb);
                }
            },
            "loader": {
                "version": "5.1.0",
                "tp_host": /*[[${@userService.tpHost()}]]*/null
            }
        };
        var sent = false;

        function sendBB(bb) {
            if (sent) return;
            var mybb = bb;
            if (bb === undefined)
                try {
                    mybb = window["IGLOO"].getBlackbox().blackbox;
                } catch (e) {
                }
            sent = true;
            console.log("Sending something...." + mybb);
            questionFw.ajaxToCurrentQuestionController({
                type: "POST",
                data: {
                    ioBlackbox: mybb
                },
                success: function (data) {
                    console.log("I finished: " + data);
                }
            }, "");
        }

        setTimeout(sendBB, 3000);
        /*]]>*/

    </script>
    <script th:src="@{__${static}__}"></script>

</th:block>
</html>