<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Demo Integration Page</title>
    <meta charset="UTF-8"/>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/jquery/jquery.min.js'}" type="text/javascript"></script>
    <script th:src="@{/js/util.js}"></script>
</head>
<body>
<div id="main">
    Sin form
    <div th:if="${doIovation}" >
        ioCheck
    </div>
    <div th:if="${!doIovation}" >
        do nothing
    </div>

    <!-- Create two hidden fields for the blackboxes to go into, one for the blackbox
    generated by the 3rd party JavaScript, and another for the blackbox generated by the 1st party
    JavaScript. In this example, the 1st party blackbox is named ioBlackBox, and the 3rd party blackbox
    is named fpBB. -->
    <!--<form th:if="${false}" th:action="@{/i/demo}" method="post" name="loginSubmitForm" id="loginSubmitForm">
        <fieldset>
            <ul>
                <input TYPE="hidden" NAME="ioBlackBox" id="ioBlackBox"/>
                <input TYPE="hidden" NAME="fpBB" id="fpBB"/>
                <li><input type="submit" id="submit1"
                           tabindex="4"/></li>
            </ul>
        </fieldset>
    </form>-->
</div>

<!-- These variables execute before the JavaScript files load. They set default values for the JavaScript. -->
<script th:if="${doIovation}" th:inline="javascript">
    // Variables for iovation hosted JavaScript
   // var io_bbout_element_id = 'ioBlackBox';
    var io_install_stm = false;
    var io_exclude_stm = 12;
    var io_install_flash = false;
    var io_enable_rip = true;
    // Variable for first party JavaScript
    //var fp_bbout_element_id = 'fpBB';
    var fp_bb_callback = function bb_update_callback(bb, complete) {
        if(complete) {
            //console.log('finished bb: ' + complete);
            var blackbox_info = fpGetBlackbox();
            if(blackbox_info.finished) {
                //console.log('finished fpBB: ' + complete);
                defaultAjax({
                    url: /*[[@{/i/demo}]]*/null,
                    type: 'POST',
                    data: {
                        fpBB: blackbox_info.blackbox,
                        ioBlackBox: bb
                    },
                    success: function (data) {
                        console.log("IO done");
                    }
                });
            }
        }
    };
</script>
<!-- Include the third-party iovation JavaScripts -->
<script th:if="${doIovation}" th:src="${base} + '/js/i/snr'"></script><!-- OK gets js from: https://ci-mpsnare.iovation.com/snare.js-->
<!-- Include first-party JavaScripts -->
<!-- IMPORTANT: Include the full path to static_wdp and dyn_wdp to prevent errors with Internet Explorer -->
<script th:if="${doIovation}" th:src="${base} + ${static}"></script><!-- OK: static resource on my server static_wdp.js -->
<script th:if="${doIovation}" th:src="${base} + '/js/i/dyn'"></script><!-- OK gets js from: https://ci-first.iovation.com/latest/dyn_wdp.js-->

</body>
</html>