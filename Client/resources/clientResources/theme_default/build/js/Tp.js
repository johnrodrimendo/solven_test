function Tp(e){var p=$.extend({container:"#camera",userFileConfig:[],showThumbnails:!0,thumbnails:[],numPics:1,msgBottom:"",messages:[]},e),m=new MobileDetect(window.navigator.userAgent),E=0,f=1200,v=1200;function l(){!B()||m.mobile()||"AndroidOS"==m.os()||"iOS"==m.os()?$("#takeButton").addClass("block-hidden"):$("#takeButton").removeClass("block-hidden"),$("#uploadButton").removeClass("block-hidden");var l,e,n=$('<div class="tp-wrap"></div>'),t=$("#buttons"),o=p.msgBottom?$('<div class="msg-block"><p id="msg">'+p.msgBottom+"</p></div>"):"",a=$('<div class="upload-block"><label for="upload" class="upload-box"><span class="box"><i class="icon icon-image-outline"></i><span class="text-white">Haz click dentro del recuadro para subir una foto</span></span><input type="file" id="upload" accept="image/*,application/pdf" '+(23==p.userFileConfig[E].id?'capture="camera':"")+' multiple="true"/></label></div>'),d=$('<div class="camera-block"><video id="camera-stream"></video><canvas></canvas><img id="snap"/><div class="controls-widgets"><a href="#" id="take-photo" title="Tomar foto" data-toggle="tooltip" data-placement="top" title="Tómate una foto"><i class="icon icon-camera"></i></a></div></div>'),i="",s=$("<ul></ul>");if(1<p.userFileConfig.length){p.userFileConfig.sort(C);for(var c=0;c<p.userFileConfig.length;c++)p.userFileConfig[c].index=c+1;for(c=0;c<p.userFileConfig.length;c++){F(p.userFileConfig[c].id);E==c&&(l=p.userFileConfig[c].id);var u='<li><label for="documentType-'+p.userFileConfig[c].id+'" class="h-input-radio '+(c==E?"radio-selected":"")+'"><input type="radio" name="documentType" class="documentType" id="documentType-'+p.userFileConfig[c].id+'" value="'+p.userFileConfig[c].id+'"/><div class="option-wrapper"><div class="iconic-option-inner"><div class="radio inline"></div><h5 class="inline">'+p.userFileConfig[c].index+"</h5></div></div></label></li>";s.append(u)}}$("#nextButton").addClass("block-hidden"),$("#sendButtonButton").addClass("block-hidden"),p.userFileConfig[E].required||$("#skipButton").removeClass("block-hidden");var r=23==p.userFileConfig[E].id?p.messages.selfie:p.messages.uploadDoc,g="";if(p.userFileConfig[E].showTooltip&&(g='<a href="#" id="open-modal-question60"> aquí</a>',$("#modalTituloQuestion_60").text(p.userFileConfig[E].name),$("#modalMessageQuestion_60").html(p.userFileConfig[E].tooltip)),o=$('<div class="msg-block"><p id="msg">'+r+g+"</p></div>"),n.append(o),p.userFileConfig[E].showImage&&n.append('<div class="image"><img src= "'+system.contextPath+"/img/"+p.userFileConfig[E].thumbnail+'"></div>'),23!=p.userFileConfig[E].id){var h=p.userFileConfig[E].required?"":'<span required="">(no obligatorio)</span>';n.append('<div class="status">'+p.userFileConfig[E].name.toUpperCase()+h+"</div>")}e=$('<div class="main-inputs"></div>').append(s),i=B()?n.append(e,o):n.append(e),$(p.container).html(i),$(".documentType").on("change",function(){var e,i;if($(this).closest(".main-inputs").addClass("block-hidden"),!B()||m.mobile()||"AndroidOS"==m.os()||"iOS"==m.os()?(n.html(a),$("#upload").on("change",function(){P($(this)[0],l),E+1==p.userFileConfig.length?($("#nextButton").addClass("block-hidden"),$("#sendButton").removeClass("block-hidden")):($("#nextButton").removeClass("block-hidden"),$("#sendButton").addClass("block-hidden"))})):t.append('<a href="#" class="anchor-button bg-red tpAction" data-target="take">Tomar una foto</a><a href="#" class="anchor-button bg-white tpAction" data-target="upload">Subir foto</a>'),null!=p.userFileConfig.length)for(i=0;i<p.userFileConfig.length;i++)p.userFileConfig[i].id==l&&(e="Sube o toma una foto de "+p.userFileConfig[i].name.toLowerCase());o=$('<div class="msg-block"><p id="msg">'+e+"</p><span></span></div>"),n.append(o)}),$("#upload").on("change",function(){P($(this)[0],l),E+1==p.userFileConfig.length?($("#nextButton").addClass("block-hidden"),$("#sendButton").removeClass("block-hidden")):($("#nextButton").removeClass("block-hidden"),$("#sendButton").addClass("block-hidden"))}),$(".main-buttons").unbind("click"),$(".main-buttons").on("click",".tpAction",function(e){switch(e.preventDefault(),$(this).data("target")){case"take":console.log("target consultando take or upload"),$("#uploadButton").addClass("c-hidden"),$("#takeButton").addClass("c-hidden"),n.html(d);var i=23==p.userFileConfig[E].id?p.messages.selfie:p.messages.uploadDoc;o=$('<div class="msg-block"><p id="msg">'+i+"</p><span></span></div>"),n.append(o),navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}).then(function(i){x=document.querySelector("#camera-stream");try{x.srcObject=i}catch(e){x.src=window.URL.createObjectURL(i)}T=i,x.play()}).catch(function(e){console.log("There was an error with accessing the camera stream: "+e.name,e)}),$("#take-photo").on("click",function(){e.preventDefault(),function(e,i,n){$("canvas")[0].getContext("2d");var t=x.videoWidth,o=x.videoHeight;n=t<i?(i=t,o):i*(o/t);var a,d,s=document.createElement("img");s.onload=function(){a=document.createElement("canvas"),d=a.getContext("2d"),a.width=i,a.height=n,d.drawImage(this,0,0,i,n),b(a.toDataURL("image/jpeg",.7),l),E+1==p.userFileConfig.length?($("#nextButton").addClass("block-hidden"),$("#sendButton").removeClass("block-hidden")):($("#nextButton").removeClass("block-hidden"),$("#sendButton").addClass("block-hidden")),!B()||m.mobile()||"AndroidOS"==m.os()||"iOS"==m.os()?$("#takeButton").addClass("c-hidden"):$("#takeButton").removeClass("c-hidden"),$("#uploadButton").removeClass("c-hidden")},s.src=e}(function(){var e=$("canvas")[0],i=e.getContext("2d"),n=x.videoWidth,t=x.videoHeight;if(n&&t)return e.width=n,e.height=t,i.drawImage(x,0,0,n,t),e.toDataURL("image/jpeg")}(),f,v)}),updateBranding();break;case"upload":$("#uploadButton").addClass("c-hidden"),$("#takeButton").removeClass("c-hidden"),n.html(a);i=23==p.userFileConfig[E].id?p.messages.selfie:p.messages.uploadDoc;o=$('<div class="msg-block"><p id="msg">'+i+"</p><span></span></div>"),n.append(o),$("#upload").on("change",function(){this.files[0].size<10485760?P($(this)[0],l):showErrorModal("El archivo tiene un tamaño más grande que el permitido")}),updateBranding()}}),p.userFileConfig[E].showTooltip&&($("#open-modal-question60").on("click",function(e){e.preventDefault(),self.openMsg1Modal(),$("#modal_msg_question60").modal("show"),console.log("lanzó el modal")}),this.openMsg1Modal=function(){$("#modal_msg_question60").modal("show")}),x&&A(),23==p.userFileConfig[E].id&&(!B()||m.mobile()||"AndroidOS"==m.os()||"iOS"==m.os()?$("#uploadButton").click():$("#takeButton").click(),updateBranding()),updateBranding()}this.init=function(){l(),B(),console.log("Compatibility: "+B())},this.uploadPictures=function(e){!function(e){for(var i=0;i<p.userFileConfig.length;i++)if(p.userFileConfig[i].required){var n=F(p.userFileConfig[i].id);if(0==n.length)return showErrorModal("Falta subir documentacion obligatoria para "+p.userFileConfig[i].name)}for(var t=[],i=0;i<u.length;i++)null==u[i].uploaded&&(u[i].uploaded=!1),u[i].uploaded||t.push(i);!function i(n,t){if(0<n.length){var e=u[n[0]],o=new FormData;o.append("file",e.image),o.append("userFileType",e.userFileType),questionFw.ajaxToCurrentQuestionController({type:"POST",data:o,cache:!1,contentType:!1,processData:!1,success:function(e){n.splice(0,1),i(n,t)}},"userfile")}else null!=t&&t()}(t,e)}(e)},$("#nextButton").on("click",function(){E++,$("#nextButton").addClass("block-hidden"),$("#sendButtonButton").addClass("block-hidden"),$("#skipButton").addClass("block-hidden"),l(),x&&A(),updateBranding()}),$("#skipButton").on("click",function(){$("#nextButton").addClass("block-hidden"),$("#sendButtonButton").addClass("block-hidden"),$("#skipButton").addClass("block-hidden"),++E!=p.userFileConfig.length?(l(),x&&A(),updateBranding()):$("#sendButton").click()});var T,c,x="",u=[];function b(e,i){c=!1;var n=F(i=null==i?p.userFileConfig[0].id:i),t=function(e){for(var i=0;i<p.userFileConfig.length;i++)if(e==p.userFileConfig[i].id)return p.userFileConfig[i]}(i),o={userFileType:i,image:e,fileName:""},a=e.split(";")[0].split("/")[1];return-1==$.inArray(a,["jpg","jpeg","png","pdf","JPG","JPEG","PNG","PDF"])?(showErrorModal("El formato del archivo no es v&aacute;lido"),void(c=!0)):n.length>=t.maxFiles?(showErrorModal("Maximo de im&aacute;genes"),void(c=!0)):(u.push(o),l(),void function(){for(var e,i=$('<div id="thumbs-block" class="thumbs-block"></div>'),n=$("<ul></ul>"),t="",o=0;o<u.length;o++){var a=u[o],d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAU8AAAFOCAYAAAAGkZ9XAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzYwMTdDNkY0N0UxMTFFOEFGRjhCQUJEQjU4N0U2NjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzYwMTdDNzA0N0UxMTFFOEFGRjhCQUJEQjU4N0U2NjkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDNjAxN0M2RDQ3RTExMUU4QUZGOEJBQkRCNTg3RTY2OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDNjAxN0M2RTQ3RTExMUU4QUZGOEJBQkRCNTg3RTY2OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pp36gEUAAA1USURBVHja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",s=a.image.split(";")[0].split("/")[1];t="pdf"!=s?(d=a.image,'<li id="thumb-'+o+'"><div class="circle"><img src=" '+d+' "/><button class="delete-pic" data-index="'+o+'"><i class="icon icon-close"></i></button></div></li>'):'<li id="thumb-'+o+'"><div class="circle"><img class="pdf-result" src=" '+d+' "/><button class="delete-pic" data-index="'+o+'"><i class="icon icon-close"></i></button></div></li>',n.html(t)}$("#takeButton").addClass("block-hidden"),$("#uploadButton").addClass("block-hidden"),e=i.html(n),$(p.container).find("#thumbs-block").remove(),$(p.container).append(e),$(".delete-pic").on("click",function(e){e.preventDefault(),function(e){u.splice(e,1),$("#sendButton").addClass("block-hidden"),$("#nextButton").addClass("block-hidden");for(var i=0;i<u.length;i++)u[i]===e&&u.splice(i,1)}($(this).data("index")),l()})}())}function C(e,i){var n=e.order,t=i.order,o=0;return t<n?o=1:n<t&&(o=-1),o}function P(e,i){if(e.files&&e.files[0])for(var n=0;n<e.files.length;n++){var t=new FileReader;t.onload=function(e){var t,o,a,d,s;"pdf"!=e.target.result.split(";")[0].split("/")[1]?(t=e.target.result,o=f,a=v,d=i,(s=new Image).onload=function(){ratio=s.height/s.width,a=s.width<o?(o=s.width,s.height):o*ratio;var e,i,n=document.createElement("img");n.onload=function(){e=document.createElement("canvas"),i=e.getContext("2d"),e.width=o,e.height=a,i.drawImage(this,0,0,o,a),b(e.toDataURL("image/jpeg",.7),d),E+1==p.userFileConfig.length?($("#nextButton").addClass("block-hidden"),$("#sendButton").removeClass("block-hidden")):(0==c?$("#nextButton").removeClass("block-hidden"):$("#nextButton").addClass("block-hidden"),$("#sendButton").addClass("block-hidden")),$("#uploadButton").removeClass("c-hidden"),!B()||m.mobile()||"AndroidOS"==m.os()||"iOS"==m.os()?$("#takeButton").addClass("c-hidden"):$("#takeButton").removeClass("c-hidden")},n.src=t},s.src=t):(b(e.target.result,i),E+1==p.userFileConfig.length?($("#nextButton").addClass("block-hidden"),$("#sendButton").removeClass("block-hidden")):(0==c?$("#nextButton").removeClass("block-hidden"):$("#nextButton").addClass("block-hidden"),$("#sendButton").addClass("block-hidden")),$("#uploadButton").removeClass("c-hidden"),!B()||m.mobile()||"AndroidOS"==m.os()||"iOS"==m.os()?$("#takeButton").addClass("c-hidden"):$("#takeButton").removeClass("c-hidden"))},t.readAsDataURL(e.files[n])}}function F(e){for(var i=[],n=0;n<u.length;n++)e==u[n].userFileType&&i.push(u[n]);return i}function B(){return navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getMedia}function A(){x.pause(),x.src="",T.getVideoTracks().forEach(function(e){e.stop()})}}