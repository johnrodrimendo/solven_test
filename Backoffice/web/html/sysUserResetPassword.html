<!DOCTYPE html>
<!--[if IE 8]>
<html class="ie8 no-js"> <![endif]-->
<!--[if IE 9]>
<html class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:shiro="http://www.pollix.at/thymeleaf/shiro"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<!--<![endif]-->
<!-- BEGIN HEAD -->

<head>
    <meta charset="ISO-8859-1"/>
    <title>Solven | New password</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <meta content="" name="description"/>
    <meta content="" name="author"/>

    <link rel="icon" type="image/png" th:href="@{/img/favicon.png}" />

    <!--[if lt IE 9]>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/metronic/global/plugins/respond.min.js'}"></script>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/metronic/global/plugins/excanvas.min.js'}"></script>
    <![endif]-->

    <!-- BEGIN GLOBAL MANDATORY RESOURCES -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&amp;subset=all" rel="stylesheet"
          type="text/css"/>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/jquery/jquery.min.js'}" type="text/javascript"></script>
    <link th:href="${@urlService.externalUrl(#httpServletRequest) + '/font-awesome/css/font-awesome.min.css'}" rel="stylesheet" type="text/css"/>
    <link th:href="${@urlService.externalUrl(#httpServletRequest) + '/simple-line-icons/simple-line-icons.min.css'}" rel="stylesheet" type="text/css"/>
    <link th:href="${@urlService.externalUrl(#httpServletRequest) + '/bootstrap/css/bootstrap.min.css'}" rel="stylesheet" type="text/css"/>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/bootstrap/js/bootstrap.min.js'}" type="text/javascript"></script>
    <link th:href="${@urlService.externalUrl(#httpServletRequest) + '/bootstrap-switch/css/bootstrap-switch.min.css'}" rel="stylesheet" type="text/css"/>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/bootstrap-switch/js/bootstrap-switch.min.js'}" type="text/javascript"></script>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/js-cookie/js.cookie.min.js'}" type="text/javascript"></script>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/jquery-slimscroll/jquery.slimscroll.min.js'}" type="text/javascript"></script>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/blockUI/jquery.blockui.min.js'}" type="text/javascript"></script>
    <!-- END GLOBAL MANDATORY RESOURCES -->
    <!-- BEGIN PAGE LEVEL PLUGINS -->
    <link th:href="${@urlService.externalUrl(#httpServletRequest) + '/select2/css/select2.min.css'}" rel="stylesheet" type="text/css"/>
    <link th:href="${@urlService.externalUrl(#httpServletRequest) + '/select2/css/select2-bootstrap.min.css'}" rel="stylesheet" type="text/css"/>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/jquery-validation/dist/jquery.validate.min.js'}" type="text/javascript"></script>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/jquery-validation/dist/additional-methods.min.js'}" type="text/javascript"></script>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/select2/js/select2.full.min.js'}" type="text/javascript"></script>
    <!-- END PAGE LEVEL PLUGINS -->
    <!-- BEGIN THEME GLOBAL RESOURCES -->
    <link th:href="${@urlService.externalUrl(#httpServletRequest) + '/metronic/global/css/components-md.min.css'}" rel="stylesheet" id="style_components"
          type="text/css"/>
    <link th:href="${@urlService.externalUrl(#httpServletRequest) + '/metronic/global/css/plugins-md.min.css'}" rel="stylesheet" type="text/css"/>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/metronic/global/scripts/app.min.js'}" type="text/javascript"></script>
    <!-- END THEME GLOBAL RESOURCES -->
    <!-- BEGIN THEME LAYOUT RESOURCES -->
    <!-- END THEME LAYOUT RESOURCES -->
    <!-- BEGIN PAGE LEVEL RESOURCES -->
    <link th:href="${@urlService.externalUrl(#httpServletRequest) + '/metronic/pages/css/login.min.css'}" rel="stylesheet" type="text/css"/>
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/metronic/pages/scripts/login.min.js'}" type="text/javascript"></script>
    <!-- END PAGE LEVEL RESOURCES -->
    <script th:src="${@urlService.externalUrl(#httpServletRequest) + '/sweetalert/sweetalert.min.js'}"></script>
    <link rel="stylesheet" type="text/css" th:href="${@urlService.externalUrl(#httpServletRequest) + '/sweetalert/sweetalert.css'}"/>
    <!-- BEGIN OWN STYLES -->
    <link th:href="@{/css/metronic_custom.css}" rel="stylesheet" type="text/css"/>
    <script th:src="@{/js/util.js}" type="text/javascript"/>
    <th:block layout:fragment="head"/>
    <!-- END OWN STYLES -->

    <!--<link rel="shortcut icon" href="favicon.ico"/>-->

</head>
<!-- END HEAD -->

<body class="login">
<script th:inline="javascript">
    /*<![CDATA[*/
    $(document).ready(function () {

        var m = /*[[${message}]]*/null;
        if (m != null) {
            alert(m);
        }

        function uploadNewPassword(){
            $('#generateButton').loading('Configurando nueva contraseña', 2);
            defaultAjax({
                url: /*[[@{/resetSysUserPassword}]]*/null,
                type: 'POST',
                showLoading:false,
                data: {
                    token : /*[[${token}]]*/null,
                    password : $('#password').val(),
                    repassword : $('#repassword').val()
                },
                success: function (data) {
                    swal({
                        title: "¡Enhorabuena!",
                        text: "La contraseña ha sido cambiada.",
                        type: "success"
                    },function() {
                        window.location.href = /*[[@{/login}]]*/null;
                    });
                },
                error: function(data) {
                    $('#generateButton').unloading();
                }
            });
        }

        $('.input-outline').on('keyup', function (e) {
            if (e.keyCode == 13) {
                $('#generateButton').click();
                e.preventDefault();
                return false;
            }
        });

        $('#generateButton').click(function (evt) {
            uploadNewPassword()
        });
    });
    /*]]>*/
</script>
<!-- BEGIN LOGO -->
<div class="logo">
    <a href="index.html">
        <img th:src="@{/img/logo.png}" alt=""/> </a>
</div>
<!-- END LOGO -->
<!-- BEGIN LOGIN -->
<div class="content">
    <!-- BEGIN LOGIN FORM -->
    <form id ="loginForm" onsubmit="return false;" >
        <h3 class="form-title font-green">Escriba una nueva contraseña para establecer su cuenta.</h3>
        <div class="alert alert-danger display-hide">
            <button class="close" data-close="alert"></button>
            <span> Las contraseñas deben ser iguales. </span>
        </div>

        <div class="form-group">
            <label class="control-label visible-ie8 visible-ie9">Contraseña</label>
            <input class="form-control form-control-solid placeholder-no-fix input-outline" type="password" autocomplete="off"
                   placeholder="Contrase&ntilde;a" id="password" name="password" /></div>

        <div class="form-group">
            <!--ie8, ie9 does not support html5 placeholder, so we just show field title for that-->
            <label class="control-label visible-ie8 visible-ie9">Contraseña</label>
            <input class="form-control form-control-solid placeholder-no-fix input-outline" type="password" autocomplete="off"
                   placeholder="Repetir Contrase&ntilde;a" id="repassword" name="repassword"/></div>

        <div class="form-group">
            <button id="generateButton" type="button" class="btn red uppercase">Regenerar</button>
        </div>
    </form>
    <!-- END LOGIN FORM -->

</div>
<div class="copyright"><span th:text="#{static.landing.info.footer(${currentYear})}"></span></div>
</body>
</html>